--t1
-- SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED - dirty read
SET TRANSACTION ISOLATION LEVEL READ COMMITTED
BEGIN TRAN
INSERT INTO PRODUCT VALUES(5,'STUFF1',3, 100)
INSERT INTO PRODUCT VALUES(6,'STUFF2',6, 100)
INSERT INTO PRODUCT VALUES(7,'STUFF3',4, 100)

SELECT *
FROM PRODUCT

ROLLBACK

--t1
-- SET TRANSACTION ISOLATION LEVEL READ COMMITTED --lost update
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ
BEGIN TRAN
DECLARE @qty INT
SELECT @qty = Quatity FROM PRODUCT WHERE ID=2

SET @qty = @qty -1
WAITFOR DELAY '00:00:10'
UPDATE PRODUCT SET Quatity = @qty WHERE ID=2

COMMIT


--t1
-- SET TRANSACTION ISOLATION LEVEL READ COMMITTED  --none repeatable read
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ
BEGIN TRAN
SELECT Quatity
FROM PRODUCT
WHERE ID =2
WAITFOR DELAY '00:00:10'
SELECT Quatity
FROM PRODUCT
WHERE ID =2
COMMIT

--t1
-- SET TRANSACTION ISOLATION LEVEL REPEATABLE READ  --phantom read
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE
BEGIN TRAN
SELECT *
FROM PRODUCT
WAITFOR DELAY '00:00:10'
SELECT *
FROM PRODUCT
COMMIT







